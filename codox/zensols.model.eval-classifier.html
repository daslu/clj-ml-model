<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>zensols.model.eval-classifier documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Interface for machine learning modeling, testing and training</span> <span class="project-version">0.0.18</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>zensols</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>model</span></div></div></li><li class="depth-3 branch"><a href="zensols.model.classifier.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>classifier</span></div></a></li><li class="depth-3 branch current"><a href="zensols.model.eval-classifier.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>eval-classifier</span></div></a></li><li class="depth-3 branch"><a href="zensols.model.execute-classifier.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>execute-classifier</span></div></a></li><li class="depth-3 branch"><a href="zensols.model.version.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>version</span></div></a></li><li class="depth-3"><a href="zensols.model.weka.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>weka</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-*default-set-type*"><div class="inner"><span>*default-set-type*</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-*throw-cross-validate*"><div class="inner"><span>*throw-cross-validate*</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-analysis-file"><div class="inner"><span>analysis-file</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-compile-results"><div class="inner"><span>compile-results</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-create-model"><div class="inner"><span>create-model</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-cross-fold-info"><div class="inner"><span>cross-fold-info</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-display-features"><div class="inner"><span>display-features</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-eval-and-write"><div class="inner"><span>eval-and-write</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-eval-and-write-results"><div class="inner"><span>eval-and-write-results</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-evaluations-file"><div class="inner"><span>evaluations-file</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-executing-two-pass.3F"><div class="inner"><span>executing-two-pass?</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-features-file"><div class="inner"><span>features-file</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-print-best-results"><div class="inner"><span>print-best-results</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-print-model-config"><div class="inner"><span>print-model-config</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-read-arff"><div class="inner"><span>read-arff</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-read-model"><div class="inner"><span>read-model</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-run-tests"><div class="inner"><span>run-tests</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-terse-results"><div class="inner"><span>terse-results</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-test-train-series-file"><div class="inner"><span>test-train-series-file</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-train-model"><div class="inner"><span>train-model</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-train-test-results"><div class="inner"><span>train-test-results</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-train-test-series"><div class="inner"><span>train-test-series</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-two-pass-model"><div class="inner"><span>two-pass-model</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-two-pass-test-instances"><div class="inner"><span>two-pass-test-instances</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-two-pass-train-instances"><div class="inner"><span>two-pass-train-instances</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-with-two-pass"><div class="inner"><span>with-two-pass</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-write-arff"><div class="inner"><span>write-arff</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-write-csv-train-test-series"><div class="inner"><span>write-csv-train-test-series</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-write-features"><div class="inner"><span>write-features</span></div></a></li><li class="depth-1"><a href="zensols.model.eval-classifier.html#var-write-model"><div class="inner"><span>write-model</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">zensols.model.eval-classifier</h1><div class="doc"><div class="markdown"><p>A <em>client</em> entry point library to help with evaluating machine learning models. This library not only wraps the Weka library but also provides additional functionality like a two pass cross validation (see <a href="zensols.model.eval-classifier.html#var-with-two-pass">with-two-pass</a>).</p></div></div><div class="public anchor" id="var-*default-set-type*"><h3>*default-set-type*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>The default type of test, which is one of:</p>
<ul>
  <li><code>:cross-validation</code>: run a N fold cross validation (default)</li>
  <li><code>:train-test</code>: train the classifier and then evaluate</li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L18">view source</a></div></div><div class="public anchor" id="var-*throw-cross-validate*"><h3>*throw-cross-validate*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>If <code>true</code>, throw an exception during cross validation for any errors. Otherwise, the error is logged and cross-validation continues. This is useful for when classifiers are used and some choke given the dataset, but you still want the other results.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L25">view source</a></div></div><div class="public anchor" id="var-analysis-file"><h3>analysis-file</h3><div class="usage"><code>(analysis-file)</code><code>(analysis-file file-format)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L47">view source</a></div></div><div class="public anchor" id="var-compile-results"><h3>compile-results</h3><div class="usage"><code>(compile-results classifier-sets feature-set-key)</code></div><div class="doc"><div class="markdown"><p>Run cross-fold validation and compile into a nice results map sorted by performance.</p>
<p>See <a href="zensols.model.classifier.html#var-compile-results">zensols.model.classifier/compile-results</a>.</p>
<ul>
  <li>
  <p><strong>classifier-sets</strong> is a key in <a href="zensols.model.weka.html#var-*classifiers*">zensols.model.weka/*classifiers*</a> or a constructed classifier (see <a href="zensols.model.weka.html#var-make-classifiers">zensols.model.weka/make-classifiers</a>)</p></li>
  <li>
  <p><strong>feature-sets-key</strong> identifies what feature set (see <strong>:feature-sets-set</strong> in <a href="zensols.model.execute-classifier.html#var-with-model-conf">zensols.model.execute-classifier/with-model-conf</a>)</p></li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L279">view source</a></div></div><div class="public anchor" id="var-create-model"><h3>create-model</h3><div class="usage"><code>(create-model classifier-sets feature-set-key)</code></div><div class="doc"><div class="markdown"><p>Create a model that can be trained. This runs cross fold validations to find the best classifier and feature set into a result that can be used with <a href="zensols.model.eval-classifier.html#var-train-model">train-model</a> and subsequently <a href="zensols.model.eval-classifier.html#var-write-model">write-model</a>.</p>
<ul>
  <li><strong>classifier-sets</strong> is a key in <a href="zensols.model.weka.html#var-*classifiers*">zensols.model.weka/*classifiers*</a> or a constructed classifier (see <a href="zensols.model.weka.html#var-make-classifiers">zensols.model.weka/make-classifiers</a>)</li>
  <li><strong>feature-sets-key</strong> identifies what feature set (see <strong>:feature-sets-set</strong> in <a href="zensols.model.execute-classifier.html#var-with-model-conf">zensols.model.execute-classifier/with-model-conf</a>)</li>
</ul>
<p>See <a href="zensols.model.eval-classifier.html#var-*throw-cross-validate*">*throw-cross-validate*</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L337">view source</a></div></div><div class="public anchor" id="var-cross-fold-info"><h3>cross-fold-info</h3><div class="usage"><code>(cross-fold-info)</code></div><div class="doc"><div class="markdown"><p>Return information about the current fold for two-pass validations. See <a href="zensols.model.weka.html#var-*cross-fold-info*">weka/*cross-fold-info*</a></p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L555">view source</a></div></div><div class="public anchor" id="var-display-features"><h3>display-features</h3><div class="usage"><code>(display-features &amp; adb-keys)</code></div><div class="doc"><div class="markdown"><p>Display features as configured in a model with <a href="zensols.model.execute-classifier.html#var-with-model-conf">zensols.model.execute-classifier/with-model-conf</a>.</p>
<p><strong>adb-keys</strong> are given to <code>:create-feature-sets-fn</code> as described in <a href="zensols.model.execute-classifier.html#var-with-model-conf">zensols.model.execute-classifier/with-model-conf</a>. In addition it includes <code>:max</code>, which is the maximum number of instances to display.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L101">view source</a></div></div><div class="public anchor" id="var-eval-and-write"><h3>eval-and-write</h3><div class="usage"><code>(eval-and-write classifier-sets set-key)</code><code>(eval-and-write classifier-sets set-key file)</code></div><div class="doc"><div class="markdown"><p>Perform a cross validation and write the results to an Excel formatted file.</p>
<p>See <a href="zensols.model.classifier.html#var-analysis-report-resource">zensols.model.classifier/analysis-report-resource</a> for where the file is written.</p>
<ul>
  <li><strong>classifier-sets</strong> is a key in <a href="zensols.model.weka.html#var-*classifiers*">zensols.model.weka/*classifiers*</a> or a constructed classifier (see <a href="zensols.model.weka.html#var-make-classifiers">zensols.model.weka/make-classifiers</a>)</li>
  <li><strong>feature-sets-key</strong> identifies what feature set (see <strong>:feature-sets-set</strong> in <a href="zensols.model.execute-classifier.html#var-with-model-conf">zensols.model.execute-classifier/with-model-conf</a>)</li>
</ul>
<p>This uses <a href="zensols.model.eval-classifier.html#var-eval-and-write-results">eval-and-write-results</a> to actually write the results.</p>
<p>See <a href="zensols.model.eval-classifier.html#var-evaluations-file">evaluations-file</a> and <a href="zensols.model.eval-classifier.html#var-*throw-cross-validate*">*throw-cross-validate*</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L436">view source</a></div></div><div class="public anchor" id="var-eval-and-write-results"><h3>eval-and-write-results</h3><div class="usage"><code>(eval-and-write-results results)</code><code>(eval-and-write-results results output-file)</code></div><div class="doc"><div class="markdown"><p>Perform a cross validation and write the results to an Excel formatted file. The data from <strong>results</strong> is obtained with <a href="zensols.model.eval-classifier.html#var-run-tests">run-tests</a>.</p>
<p>See <a href="zensols.model.eval-classifier.html#var-eval-and-write">eval-and-write</a> and <a href="zensols.model.eval-classifier.html#var-*throw-cross-validate*">*throw-cross-validate*</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L420">view source</a></div></div><div class="public anchor" id="var-evaluations-file"><h3>evaluations-file</h3><div class="usage"><code>(evaluations-file)</code><code>(evaluations-file fname)</code></div><div class="doc"><div class="markdown"><p>Return the default file used to create an evaluations file with <a href="zensols.model.eval-classifier.html#var-eval-and-write">eval-and-write</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L410">view source</a></div></div><div class="public anchor" id="var-executing-two-pass.3F"><h3>executing-two-pass?</h3><div class="usage"><code>(executing-two-pass?)</code></div><div class="doc"><div class="markdown"><p>Return <code>true</code> if we’re currently using a two pass cross validation.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L549">view source</a></div></div><div class="public anchor" id="var-features-file"><h3>features-file</h3><div class="usage"><code>(features-file)</code></div><div class="doc"><div class="markdown"><p>Return the default file used to create the features output file with <a href="zensols.model.eval-classifier.html#var-write-features">write-features</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L112">view source</a></div></div><div class="public anchor" id="var-print-best-results"><h3>print-best-results</h3><div class="usage"><code>(print-best-results classifier-sets feature-set-key)</code></div><div class="doc"><div class="markdown"><p>Print the highest (best) scored cross validation information.</p>
<ul>
  <li><strong>classifier-sets</strong> is a key in <a href="zensols.model.weka.html#var-*classifiers*">zensols.model.weka/*classifiers*</a> or a constructed classifier (see <a href="zensols.model.weka.html#var-make-classifiers">zensols.model.weka/make-classifiers</a>)</li>
  <li><strong>feature-sets-key</strong> identifies what feature set (see <strong>:feature-sets-set</strong> in <a href="zensols.model.execute-classifier.html#var-with-model-conf">zensols.model.execute-classifier/with-model-conf</a>)</li>
</ul>
<p>See <a href="zensols.model.eval-classifier.html#var-*throw-cross-validate*">*throw-cross-validate*</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L324">view source</a></div></div><div class="public anchor" id="var-print-model-config"><h3>print-model-config</h3><div class="usage"><code>(print-model-config)</code></div><div class="doc"><div class="markdown"><p>Pretty print the model configuation set with <a href="zensols.model.execute-classifier.html#var-with-model-conf">zensols.model.execute-classifier/with-model-conf</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L41">view source</a></div></div><div class="public anchor" id="var-read-arff"><h3>read-arff</h3><div class="usage"><code>(read-arff)</code><code>(read-arff file)</code></div><div class="doc"><div class="markdown"><p>Read the ARFF file configured with <a href="zensols.model.execute-classifier.html#var-with-model-conf">zensols.model.execute-classifier/with-model-conf</a>. If <strong>file</strong> is given, use that file instead of getting it from <a href="zensols.model.classifier.html#var-analysis-report-resource">zensols.model.classifier/analysis-report-resource</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L55">view source</a></div></div><div class="public anchor" id="var-read-model"><h3>read-model</h3><div class="usage"><code>(read-model)</code></div><div class="doc"><div class="markdown"><p>Read a model that was previously persisted to the file system.</p>
<p>See <a href="null">zensols.model.classifier/model-dir</a> for where the model is read from.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L403">view source</a></div></div><div class="public anchor" id="var-run-tests"><h3>run-tests</h3><div class="usage"><code>(run-tests classifier-sets feature-set-key)</code></div><div class="doc"><div class="markdown"><p>Create result sets useful to functions like <a href="zensols.model.eval-classifier.html#var-eval-and-write">eval-and-write</a>. This package was designed for most use cases to not have to use this function.</p>
<p>See <a href="zensols.model.eval-classifier.html#var-*throw-cross-validate*">*throw-cross-validate*</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L266">view source</a></div></div><div class="public anchor" id="var-terse-results"><h3>terse-results</h3><div class="usage"><code>(terse-results classifier-sets feature-set-key &amp; {:keys [only-stats?], :or {only-stats? true}})</code></div><div class="doc"><div class="markdown"><p>Return terse cross-validation results in an array: * classifier name * weighted F-measure * feature-metas</p>
<ul>
  <li>
  <p><strong>classifier-sets</strong> is a key in <a href="zensols.model.weka.html#var-*classifiers*">zensols.model.weka/*classifiers*</a> or a constructed classifier (see <a href="zensols.model.weka.html#var-make-classifiers">zensols.model.weka/make-classifiers</a>)</p></li>
  <li>
  <p><strong>feature-sets-key</strong> identifies what feature set (see <strong>:feature-sets-set</strong> in <a href="zensols.model.execute-classifier.html#var-with-model-conf">zensols.model.execute-classifier/with-model-conf</a>)</p></li>
</ul>
<h2><a href="#keys" name="keys"></a>Keys</h2>
<ul>
  <li><strong>:only-stats?</strong> if <code>true</code> only return statistic data</li>
</ul>
<p>See <a href="zensols.model.eval-classifier.html#var-*throw-cross-validate*">*throw-cross-validate*</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L294">view source</a></div></div><div class="public anchor" id="var-test-train-series-file"><h3>test-train-series-file</h3><div class="usage"><code>(test-train-series-file)</code><code>(test-train-series-file fname)</code></div><div class="doc"><div class="markdown"><p>Return the default file used to create an evaluations file with <a href="zensols.model.eval-classifier.html#var-eval-and-write">eval-and-write</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L490">view source</a></div></div><div class="public anchor" id="var-train-model"><h3>train-model</h3><div class="usage"><code>(train-model model &amp; {:keys [set-type], :or {set-type *default-set-type*}})</code></div><div class="doc"><div class="markdown"><p>Train a model created from <a href="zensols.model.eval-classifier.html#var-create-model">create-model</a>. The model is trained on the full available dataset. After the classifier is trained, you can save it to disk by calling <a href="zensols.model.eval-classifier.html#var-write-model">write-model</a>.</p>
<ul>
  <li><strong>model</strong> a model that was created with <a href="zensols.model.eval-classifier.html#var-create-model">create-model</a></li>
</ul>
<p>See <a href="zensols.model.eval-classifier.html#var-*throw-cross-validate*">*throw-cross-validate*</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L355">view source</a></div></div><div class="public anchor" id="var-train-test-results"><h3>train-test-results</h3><div class="usage"><code>(train-test-results classifier-sets feature-sets-key)</code></div><div class="doc"><div class="markdown"><p>Test the performance of a model by training on a given set of data and evaluate on the test data.</p>
<p>See <a href="zensols.model.eval-classifier.html#var-train-model">train-model</a> for parameter details.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L226">view source</a></div></div><div class="public anchor" id="var-train-test-series"><h3>train-test-series</h3><div class="usage"><code>(train-test-series classifiers meta-set divide-ratio-config)</code></div><div class="doc"><div class="markdown"><p>Test and train with different rations and return the results. The return data is writable directly as an Excel file. However, you can also save it as a CSV with <a href="zensols.model.eval-classifier.html#var-write-csv-train-test-series">write-csv-train-test-series</a>.</p>
<p>The keys are the classifier name and the values are the 2D result matrix.</p>
<p>See <a href="zensols.model.eval-classifier.html#var-*throw-cross-validate*">*throw-cross-validate*</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L455">view source</a></div></div><div class="public anchor" id="var-two-pass-model"><h3>two-pass-model</h3><div class="usage"><code>(two-pass-model model id-key anon-by-id-fn anons-fn)</code></div><div class="doc"><div class="markdown"><p>Don’t use this function–instead, use <a href="zensols.model.eval-classifier.html#var-with-two-pass">with-two-pass</a>.</p>
<p>Create a two pass model, which should be merged with the model created with <a href="zensols.model.execute-classifier.html#var-with-model-conf">zensols.model.execute-classifier/with-model-conf</a>.</p>
<p>See <a href="zensols.model.eval-classifier.html#var-with-two-pass">with-two-pass</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L517">view source</a></div></div><div class="public anchor" id="var-two-pass-test-instances"><h3>two-pass-test-instances</h3><div class="usage"><code>(two-pass-test-instances insts train-state org folds fold)</code></div><div class="doc"><div class="markdown"><p>Don’t use this function–instead, use <a href="zensols.model.eval-classifier.html#var-with-two-pass">with-two-pass</a>.</p>
<p>This is called by the <a href="zensols.model.weka.html">zensols.model.weka</a> namespace.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L609">view source</a></div></div><div class="public anchor" id="var-two-pass-train-instances"><h3>two-pass-train-instances</h3><div class="usage"><code>(two-pass-train-instances insts state org folds fold)</code></div><div class="doc"><div class="markdown"><p>Don’t use this function–instead, use <a href="zensols.model.eval-classifier.html#var-with-two-pass">with-two-pass</a>.</p>
<p>This is called by the <a href="zensols.model.weka.html">zensols.model.weka</a> namespace.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L570">view source</a></div></div><div class="public anchor" id="var-with-two-pass"><h3>with-two-pass</h3><h4 class="type">macro</h4><div class="usage"><code>(with-two-pass model-conf opts &amp; forms)</code></div><div class="doc"><div class="markdown"><p>Like <code>with-model-conf</code>, but compute a context state (i.e. statistics needed by the model) on a per fold when executing a cross fold validation.</p>
<p>The <code>model-conf</code> parameter is the same model used with <a href="zensols.model.execute-classifier.html#var-with-model-conf">zensols.model.execute-classifier/with-model-conf</a>.</p>
<h2><a href="#description" name="description"></a>Description</h2>
<p>Two pass validation is a term used in this library. During cross-validation the entire data set is evaluated and (usually) statistics or some other additional modeling happens.</p>
<p>Take for example you want to count words (think Naive Bays spam filter). If create features for the entire dataset before cross-validation you’re “cheating” because the features are based on data not seen from the test folds.</p>
<p>To get more accurate performance metrics you can provide functions that takes the current training fold, compute your word counts and create your features. During the testing phase, the computed data is provided to create features based on only that (current) fold.</p>
<p>To use two pass validation ever feature set needs a unique key (not needed as a feature). This key is then given to a function during validation to get the corresponding feature set that is to be <em>stitched</em> in.</p>
<p><strong>Note</strong> This is <em>only</em> useful if:</p>
<ol>
  <li>You want to use cross fold validation to test your model.</li>
  <li>Your model priors (*context* in implementation parlance) is composed of  the dataset preproessing, and thus, needed to get reliable performance  metrics.</li>
</ol>
<h2><a href="#option-keys" name="option-keys"></a>Option Keys</h2>
<p>In addition to all keys documented in <a href="zensols.model.execute-classifier.html#var-with-model-conf">zensols.model.execute-classifier/with-model-conf</a>, the <strong>opts</strong> param is a map that also needs the following key/value pairs:</p>
<ul>
  <li><strong>:id-key</strong> a function that takes a key as input and returns a feature set</li>
  <li><strong>:anon-by-id-fn</strong> is a function that takes a single integer argument of the annotation to retrieve by ID</li>
  <li><strong>:anons-fn</strong> is a function that retrieves all annotations</li>
  <li><strong>:create-two-pass-context-fn</strong> like <code>:create-context-fn</code>, as documented in <a href="zensols.model.execute-classifier.html#var-with-model-conf">zensols.model.execute-classifier/with-model-conf</a> but called for two pass cross validation; this allows a more general context and a specific two pass context to be created for the unique needs of the model.</li>
</ul>
<h2><a href="#example" name="example"></a>Example</h2>
<pre><code>(with-two-pass (create-model-config)
  {:id-key sf/id-key
   :anon-by-id-fn #(-&gt;&gt; % adb/anon-by-id :instance)
   :anons-fn adb/anons}
(with-feature-context (sf/create-context :anons-fn adb/anons
                                         :set-type :train-test)
  (ec/terse-results [:j48] :set-test-two-pass :only-stats? true)))
</code></pre>
<p>See a <a href="https://github.com/plandes/clj-example-nlp-ml/blob/master/src/clojure/zensols/example/sa_tp_eval.clj">working example</a> for a more comprehensive code listing.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L638">view source</a></div></div><div class="public anchor" id="var-write-arff"><h3>write-arff</h3><div class="usage"><code>(write-arff)</code><code>(write-arff file)</code></div><div class="doc"><div class="markdown"><p>Write the ARFF file configured with <a href="zensols.model.execute-classifier.html#var-with-model-conf">zensols.model.execute-classifier/with-model-conf</a>. If <strong>file</strong> is given, use that file instead of getting it from <a href="zensols.model.classifier.html#var-analysis-report-resource">zensols.model.classifier/analysis-report-resource</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L65">view source</a></div></div><div class="public anchor" id="var-write-csv-train-test-series"><h3>write-csv-train-test-series</h3><div class="usage"><code>(write-csv-train-test-series res)</code><code>(write-csv-train-test-series res out-file)</code></div><div class="doc"><div class="markdown"><p>Write the results produced with <a href="zensols.model.eval-classifier.html#var-train-test-series">train-test-series</a> as a CSV file to the analysis directory.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L501">view source</a></div></div><div class="public anchor" id="var-write-features"><h3>write-features</h3><div class="usage"><code>(write-features)</code><code>(write-features file)</code></div><div class="doc"><div class="markdown"><p>Write features as configured in a model with <a href="zensols.model.execute-classifier.html#var-with-model-conf">zensols.model.execute-classifier/with-model-conf</a> to a CSV spreadsheet file.</p>
<p>See <a href="zensols.model.eval-classifier.html#var-features-file">features-file</a> for the default file</p>
<p>For the non-zero-arg form, see <a href="zensols.model.execute-classifier.html#var-with-model-conf">zensols.model.execute-classifier/with-model-conf</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L118">view source</a></div></div><div class="public anchor" id="var-write-model"><h3>write-model</h3><div class="usage"><code>(write-model model)</code><code>(write-model model name)</code></div><div class="doc"><div class="markdown"><p>Persist/write the model to disk.</p>
<ul>
  <li><strong>model</strong> a model that was trained with <a href="zensols.model.eval-classifier.html#var-train-model">train-model</a></li>
</ul>
<p>See <a href="null">zensols.model.classifier/model-dir</a> for information about to where the model is written.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/eval_classifier.clj#L382">view source</a></div></div></div></body></html>