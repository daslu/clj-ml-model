<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>zensols.model.execute-classifier documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Interface for machine learning modeling, testing and training</span> <span class="project-version">0.0.18</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>zensols</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>model</span></div></div></li><li class="depth-3 branch"><a href="zensols.model.classifier.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>classifier</span></div></a></li><li class="depth-3 branch"><a href="zensols.model.eval-classifier.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>eval-classifier</span></div></a></li><li class="depth-3 branch current"><a href="zensols.model.execute-classifier.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>execute-classifier</span></div></a></li><li class="depth-3 branch"><a href="zensols.model.version.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>version</span></div></a></li><li class="depth-3"><a href="zensols.model.weka.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>weka</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-classifier-file"><div class="inner"><span>classifier-file</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-classify"><div class="inner"><span>classify</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-confusion-matrix-file"><div class="inner"><span>confusion-matrix-file</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-cross-fold-instances"><div class="inner"><span>cross-fold-instances</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-display-predictions"><div class="inner"><span>display-predictions</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-dump-model-info"><div class="inner"><span>dump-model-info</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-model-classifier-feature-types"><div class="inner"><span>model-classifier-feature-types</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-model-classifier-label"><div class="inner"><span>model-classifier-label</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-model-config"><div class="inner"><span>model-config</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-model-exists.3F"><div class="inner"><span>model-exists?</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-predict"><div class="inner"><span>predict</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-predictions-file"><div class="inner"><span>predictions-file</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-prime-model"><div class="inner"><span>prime-model</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-print-model-info"><div class="inner"><span>print-model-info</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-read-model"><div class="inner"><span>read-model</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-train-test-instances"><div class="inner"><span>train-test-instances</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-with-model-conf"><div class="inner"><span>with-model-conf</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-write-classifier"><div class="inner"><span>write-classifier</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-write-confusion-matrix"><div class="inner"><span>write-confusion-matrix</span></div></a></li><li class="depth-1"><a href="zensols.model.execute-classifier.html#var-write-predictions"><div class="inner"><span>write-predictions</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">zensols.model.execute-classifier</h1><div class="doc"><div class="markdown"><p>A <em>client</em> entry point library to help with executing a trained classifier. The classifier is tested and trained in the <a href="zensols.model.eval-classifier.html">zensols.model.eval-classifier</a> namespace.</p>
<p>This library expects that you configure your model. To learn how to do that, see <a href="zensols.model.execute-classifier.html#var-with-model-conf">with-model-conf</a> and see the <a href="https://github.com/plandes/clj-ml-model">repo docs</a>.</p></div></div><div class="public anchor" id="var-classifier-file"><h3>classifier-file</h3><div class="usage"><code>(classifier-file model)</code></div><div class="doc"><div class="markdown"><p>Return the default file used to create a model data file with <a href="zensols.model.execute-classifier.html#var-write-classifier">write-classifier</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L246">view source</a></div></div><div class="public anchor" id="var-classify"><h3>classify</h3><div class="usage"><code>(classify model &amp; data)</code></div><div class="doc"><div class="markdown"><p>Classify a single instance using a trained model.</p>
<ul>
  <li><strong>model</strong> a model created from <a href="zensols.model.eval-classifier.html#var-train-model">zensols.model.eval-classifier/train-model</a> or <a href="zensols.model.execute-classifier.html#var-read-model">read-model</a></li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L314">view source</a></div></div><div class="public anchor" id="var-confusion-matrix-file"><h3>confusion-matrix-file</h3><div class="usage"><code>(confusion-matrix-file model)</code></div><div class="doc"><div class="markdown"><p>Return the default file used to create a confusion matrix spreadsheet file with <a href="null">write-confusion-model</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L413">view source</a></div></div><div class="public anchor" id="var-cross-fold-instances"><h3>cross-fold-instances</h3><div class="usage"><code>(cross-fold-instances)</code></div><div class="doc"><div class="markdown"><p>Called by <a href="null">eval-classifier</a> to create the data set for cross validation. See <a href="null">create-instances</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L120">view source</a></div></div><div class="public anchor" id="var-display-predictions"><h3>display-predictions</h3><div class="usage"><code>(display-predictions predictions)</code></div><div class="doc"><div class="markdown"><p>Display <strong>predictions</strong> given by <a href="zensols.model.execute-classifier.html#var-predict">predict</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L373">view source</a></div></div><div class="public anchor" id="var-dump-model-info"><h3>dump-model-info</h3><div class="usage"><code>(dump-model-info model &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Write all data from <a href="zensols.model.execute-classifier.html#var-print-model-info">print-model-info</a> to the file system.</p>
<p>See <a href="null">zensols.model.classifier/modeldir</a> for where the model is read from and <a href="zensols.model.classifier.html#var-analysis-report-resource">zensols.model.classifier/analysis-report-resource</a> for information about to where the model information is written.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L229">view source</a></div></div><div class="public anchor" id="var-model-classifier-feature-types"><h3>model-classifier-feature-types</h3><div class="usage"><code>(model-classifier-feature-types)</code><code>(model-classifier-feature-types context)</code></div><div class="doc"><div class="markdown"><p>Return the feature metadatas from the model config.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L85">view source</a></div></div><div class="public anchor" id="var-model-classifier-label"><h3>model-classifier-label</h3><div class="usage"><code>(model-classifier-label)</code></div><div class="doc"><div class="markdown"><p>Return the class label metadata from the model config.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L80">view source</a></div></div><div class="public anchor" id="var-model-config"><h3>model-config</h3><div class="usage"><code>(model-config)</code></div><div class="doc"><div class="markdown"><p>Return the currently bound model configuration.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L73">view source</a></div></div><div class="public anchor" id="var-model-exists.3F"><h3>model-exists?</h3><div class="usage"><code>(model-exists?)</code></div><div class="doc"><div class="markdown"><p>Return whether a model file exists on the file system.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L154">view source</a></div></div><div class="public anchor" id="var-predict"><h3>predict</h3><div class="usage"><code>(predict model &amp; {:keys [set-type feature-sets], :or {set-type :test}})</code></div><div class="doc"><div class="markdown"><p>Create predictions using the provided model.</p>
<h2><a href="#keys" name="keys"></a>Keys</h2>
<ul>
  <li><strong>:set-type</strong> the set to draw the test data, which defaults to <code>:test</code></li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L335">view source</a></div></div><div class="public anchor" id="var-predictions-file"><h3>predictions-file</h3><div class="usage"><code>(predictions-file model)</code></div><div class="doc"><div class="markdown"><p>Return the default file used to create a predictions spreadsheet file with <a href="zensols.model.execute-classifier.html#var-write-predictions">write-predictions</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L383">view source</a></div></div><div class="public anchor" id="var-prime-model"><h3>prime-model</h3><div class="usage"><code>(prime-model model)</code></div><div class="doc"><div class="markdown"><p>Prime a trained or unpersisted (<a href="zensols.model.execute-classifier.html#var-read-model">read-model</a>) model for classification with <a href="zensols.model.execute-classifier.html#var-classify">classify</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L173">view source</a></div></div><div class="public anchor" id="var-print-model-info"><h3>print-model-info</h3><div class="usage"><code>(print-model-info model &amp; {:keys [metrics? attributes? features? classifier? context? results?], :or {metrics? true, attributes? true, features? false, classifier? false, context? false, results? true}})</code></div><div class="doc"><div class="markdown"><p>Print informtation from a (usually serialized) model. This data includes performance metrics, the classifier, features used to create the model and the context (see <a href="zensols.model.execute-classifier.html">zensols.model.execute-classifier</a>).</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L196">view source</a></div></div><div class="public anchor" id="var-read-model"><h3>read-model</h3><div class="usage"><code>(read-model &amp; {:keys [fail-if-not-exists? file], :or {fail-if-not-exists? true, file (:name (model-config))}})</code></div><div class="doc"><div class="markdown"><p>Read/unpersist the model from the file system. If <strong>file</strong> is given, use that file instead of getting it from <a href="zensols.model.classifier.html#var-analysis-report-resource">zensols.model.classifier/analysis-report-resource</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L159">view source</a></div></div><div class="public anchor" id="var-train-test-instances"><h3>train-test-instances</h3><div class="usage"><code>(train-test-instances)</code></div><div class="doc"><div class="markdown"><p>Called by <a href="null">eval-classifier</a> to create the data set for cross validation. See <a href="null">create-instances</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L132">view source</a></div></div><div class="public anchor" id="var-with-model-conf"><h3>with-model-conf</h3><h4 class="type">macro</h4><div class="usage"><code>(with-model-conf model-config &amp; body)</code></div><div class="doc"><div class="markdown"><p>Evaluates body with a model configuration.</p>
<p>An example of how this is used is in the <a href="https://github.com/plandes/clj-example-nlp-ml/blob/master/src/clojure/zensols/example/sa_tp_eval.clj">example repo</a>.</p>
<p>The model configuration is a map with the following keys:</p>
<ul>
  <li><strong>:name</strong> human readable short name, which is used in file names and spreadsheet cells</li>
  <li><strong>:create-feature-sets-fn</strong> function creates a sequence of maps with each map having key/value pairs of the features of the model to be populated; it is passed with optional keys:
    <ul>
      <li><strong>:set-type</strong> the data set type: <code>:test</code> or <code>:train</code>, which uses the <a href="https://plandes.github.io/clj-ml-dataset/codox/zensols.dataset.db.html#var-instances">data set library</a> convention for easy integration</li>
    </ul>
  </li>
  <li><strong>:create-features-fn</strong> just like <strong>create-feature-sets-fn</strong> but creates a single feature map used for test/execution after the classifier is built; it’s called with the arguments that <a href="zensols.model.execute-classifier.html#var-classify">classify</a> is given to classify an instance along with the context generated at train time by <strong>:context-fn</strong> if it was provided (see below)–therefore you must provide a two argument function if a context is provided at train time</li>
  <li><strong>:feature-metas-fn</strong> a function that creates a map of key/value pairs describing the features where the values are <code>string</code>, <code>boolean</code>, <code>numeric</code>, or a sequence of strings representing possible enumeration values</li>
  <li><strong>:display-feature-metas-fn</strong> like <strong>:feature-metas-fn</strong> but used to display (i.e. while debugging)</li>
  <li><strong>:class-feature-meta-fn</strong> just like a <strong>feature-metas-fn</strong> but describes the class</li>
  <li><strong>:context-fn</strong> a function that creates a context (ie. stats on the entire training set) and passed to <strong>:create-features-fn</strong></li>
  <li><strong>:set-context-fn</strong> (optional) a function that is called to set the context created with <strong>:context-fn</strong> and retrieved from the persisted model; this is useful when using/executing the model and the context is needed before <strong>:create-features-fn</strong> is called; if this function is provided it replaces the unpersisted context in case there is any <em>thawing</em> logic that might be needed for the model</li>
  <li><strong>:model-return-keys</strong> what the classifier will return (by default <code>{:label :distributions}</code>)</li>
  <li><strong>:cross-fold-instances-inst</strong> at atom used to cache the <code>weka.core.Instances</code> generated from <strong>:create-feature-sets-fn</strong>; when this atom is derefed as <code>nil</code> <strong>:create-feature-sets-fn</strong> is called to create the feature maps</li>
  <li><strong>:feature-sets-set</strong> a map of key/value pairs where keys are names of feature sets and the values are lists of lists of features as symbols</li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L23">view source</a></div></div><div class="public anchor" id="var-write-classifier"><h3>write-classifier</h3><div class="usage"><code>(write-classifier model)</code><code>(write-classifier model file)</code></div><div class="doc"><div class="markdown"><p>Serialize (just) the classifier to the file system.</p>
<p>The <strong>model</strong> parameter is a model created from <a href="zensols.model.eval-classifier.html#var-train-model">zensols.model.eval-classifier/train-model</a>. If <strong>file</strong> is given, use that file instead of getting it from <a href="zensols.model.classifier.html#var-analysis-report-resource">zensols.model.classifier/analysis-report-resource</a>.</p>
<p>See <a href="zensols.model.execute-classifier.html#var-classifier-file">classifier-file</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L253">view source</a></div></div><div class="public anchor" id="var-write-confusion-matrix"><h3>write-confusion-matrix</h3><div class="usage"><code>(write-confusion-matrix model)</code><code>(write-confusion-matrix model output-file)</code></div><div class="doc"><div class="markdown"><p>Write the confusion matrix in <strong>model</strong>.</p>
<ul>
  <li><strong>model</strong> a model created from <a href="zensols.model.eval-classifier.html#var-train-model">zensols.model.eval-classifier/train-model</a> or <a href="zensols.model.execute-classifier.html#var-read-model">read-model</a></li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L420">view source</a></div></div><div class="public anchor" id="var-write-predictions"><h3>write-predictions</h3><div class="usage"><code>(write-predictions prediction)</code><code>(write-predictions predictions file)</code></div><div class="doc"><div class="markdown"><p>Write <strong>predictions</strong> given by <a href="zensols.model.execute-classifier.html#var-predict">predict</a> to the analysis directory. If <strong>file</strong> is given, use that file instead of getting it from <a href="zensols.model.classifier.html#var-analysis-report-resource">zensols.model.classifier/analysis-report-resource</a>.</p>
<p>See <a href="zensols.model.classifier.html#var-analysis-report-resource">zensols.model.classifier/analysis-report-resource</a> for information about to where the spreadsheet is written.</p>
<p>See <a href="zensols.model.execute-classifier.html#var-predictions-file">predictions-file</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-ml-model/blob/v0.0.18/src/clojure/zensols/model/execute_classifier.clj#L390">view source</a></div></div></div></body></html>